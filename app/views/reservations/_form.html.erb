<div class="panel panel-default">
  <div class="panel-heading">
    <span><i class="fa fa-bolt" style="color: #ffb400"></i> $<%= @tour.price %></span>
    <span class="pull-right">Per Hour</span>
  </div>
  <div class="panel-body">
    <%= form_for([@tour, @tour.reservations.new]) do |f| %>
      <div class="row">
        <%= f.text_field :start_date, readonly: true, placeholder: "Start Date"%>
      </div>

      <h4 class="message-alert text-center"><span id="message"></span></h4>
      <div id="preview" style="display: none">
        <table class="reservation-table">
          <tbody>
            <tr>
              <td>Price</td>
              <td class="text-right">$<%= @tour.price %></td>
            </tr>
            <tr>
              <td>Hour(s)</td>
              <td class="text-right">x <span id="reservation_nights"></span></td>
            </tr>
            <tr>
              <td class="total">Total</td>
              <td class="text-right">$<span id="reservation_total"></span></td>
            </tr>
          </tbody>
        </table>
      </div>

      <%= f.submit "Book Now", id: "btn_book", class: "btn btn-normal btn-block"%>
    <% end %>
  </div>
</div>

<script>
  $(function() {
    unavailableDates = [];
    
    $.ajax({
      url: '<%= preload_tour_path(@tour) %>',
      dateTyp: 'json',
      success: function(data) {

        $.each(data, function(arrID, arrValue) {
          console.log(arrID);
          console.log(arrValue);
          console.log(arrValue.start_date + arrValue.duration)
            for(var d = new Date(arrValue.start_date); d <= new Date(arrValue.start_date + (arrValue.duration/24.0)); d.setDate(d.getDate() + 1)) {
              console.log(d);
              console.log("hello")
            }
        });
      }
    });
    console.log("hello3");
    
    $('#reservation_start_date').datetimepicker({
      format: 'd.m.Y H:i',
      inline:true,
      lang:'en'
    });
  });
</script>